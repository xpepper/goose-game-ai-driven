Ok, I changed a bit your proposed refactorings, but overall it makes sense
